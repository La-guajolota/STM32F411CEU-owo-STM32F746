/* USER CODE BEGIN Header */
/**
  ******************************************************************************
  * @file           : main.c
  * @brief          : Main program body
  ******************************************************************************
  * @attention
  *
  * Copyright (c) 2024 STMicroelectronics.
  * All rights reserved.
  *
  * This software is licensed under terms that can be found in the LICENSE file
  * in the root directory of this software component.
  * If no LICENSE file comes with this software, it is provided AS-IS.
  *
  ******************************************************************************
  */
/* USER CODE END Header */
/* Includes ------------------------------------------------------------------*/
#include "main.h"

/* Private includes ----------------------------------------------------------*/
/* USER CODE BEGIN Includes */
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>
#include <math.h>
#include <time.h>

#include "edge-impulse-sdk/classifier/ei_run_classifier.h"

using namespace ei;

// paste the raw features here
static float features[] = {
		30749, 34043, 37039, 36323, 39051, 45529, 43724, 45593, 49800, 50463, 53130, 51696, 53603, 57032, 60473, 61536, 58188, 63183, 62104, 61365, 65535, 64528, 65535, 65535, 65535, 65535, 63794, 65535, 65535, 65535, 65535, 62766, 62417, 58771, 61178, 62013, 58565, 55129, 53201, 52766, 50652, 49142, 45793, 48470, 43238, 39837, 40734, 37189, 37725, 36303, 33895, 31726, 31396, 27335, 24382, 19623, 21751, 20946, 16467, 14942, 11986, 11358, 12805, 5867, 6413, 6269, 6629, 1236, 6093, 0, 4461, 3264, 440, 0, 0, 2829, 0, 1504, 3537, 1114, 3965, 4, 1543, 5916, 2189, 6415, 4691, 7370, 8532, 14361, 14830, 16800, 16503, 21295, 23178, 21161, 22924, 23359, 27530, 31542, 31641, 33081, 37313, 38026, 40576, 40276, 47997, 44194, 47977, 50060, 52351, 56254, 54909, 56734, 56440, 58027, 62454, 63782, 65194, 60914, 64415, 63883, 65535, 65535, 62995, 65535, 63760, 65535, 62891, 64179, 64698, 65181, 63221, 62524, 61486, 62386, 58504, 56750, 53191, 51841, 52163, 50318, 48745, 47906, 45976, 40901, 42645, 41924, 36916, 35619, 30238, 33390, 30255, 26976, 23198, 20183, 23281, 18213, 18912, 14871, 11932, 14035, 13294, 8753, 10643, 3225, 5161, 2725, 0, 2763, 2645, 0, 0, 3059, 0, 1348, 0, 1492, 3409, 3757, 3713, 1497, 4955, 4635, 7439, 4771, 6470, 11742, 11070, 10834, 11934, 15587, 16670, 16422, 21732, 23760, 27052, 26101, 29300, 30621, 33046, 35752, 36429, 36573, 42567, 45877, 46507, 44257, 50384, 47476, 54845, 52412, 52245, 53916, 55832, 58377, 57882, 62036, 63325, 61135, 65535, 63813, 64421, 64827, 65535, 65535, 64589, 63084, 65348, 65535, 61309, 64712, 61129, 59051, 62147, 60390, 55840, 56387, 52504, 54125, 48915, 47061, 45327, 49785, 44099, 44907, 43759, 37061, 39501, 36084, 32198, 33125, 31601, 27409, 22519, 22457, 23727, 18279, 18072, 12917, 11520, 12511, 7232, 5881, 8710, 6441, 6375, 984, 4702, 947, 0, 0, 0, 0, 0, 1767, 0, 3276, 375, 0, 2412, 5480, 4552, 4828, 2127, 5042, 8533, 9618, 13218, 10902, 10364, 12154, 17555, 17307, 19738, 24182, 24255, 28088, 25489, 31583, 32032, 37086, 38397, 38632, 42394, 44441, 42531, 47123, 46395, 51475, 51380, 50606, 53477, 55166, 59837, 57106, 58856, 61234, 65415, 65535, 64142, 61408, 62920, 65535, 65535, 64403, 65535, 62525, 63778, 61695, 63249, 61422, 64596, 64371, 61598, 60702, 55505, 59376, 52463, 54107, 51703, 51089, 46244, 49597, 42116, 44512, 41754, 42062, 39199, 37933, 29697, 31600, 31596, 26794, 21554, 22906, 20361, 19159, 17598, 17021, 12303, 9620, 9098, 8124, 9538, 3795, 2778, 1685, 5992, 56, 0, 1132, 1819, 732, 0, 1569, 0, 0, 0, 2043, 3975, 3451, 5729, 6003, 4351, 4317, 6678, 8636, 12464, 12102, 13098, 12473, 19210, 21532, 17473, 22505, 21394, 29876, 30128, 28328, 32993, 35771, 35812, 41118, 39317, 40513, 42881, 43608, 48617, 53545, 48785, 53939, 57397, 54513, 55341, 61813, 59289, 63584, 61741, 62976, 61647, 61676, 65150, 64870, 63512, 65535, 65535, 65535, 64703, 63269, 63226, 63850, 64874, 63135, 57869, 57003, 60616, 57142, 54320, 50668, 53948, 52755, 48573, 49241, 45657, 43319, 38674, 36518, 37967, 34204, 35983, 32673, 25569, 26495, 21911, 21668, 18623, 21880, 15321, 14979, 12835, 12164, 11687, 11334, 4804, 3468, 4641, 2468, 4729, 2602, 2982, 343, 3144, 0, 476, 0, 1284, 0, 0, 1138, 4400, 4660, 5336, 2091, 6311, 7709, 7330, 5929, 7927, 14656, 15775, 15656, 16048, 20855, 23755, 23519, 24819, 23946, 29738, 31226, 30618, 33964, 34164, 40826, 42431, 40423, 42687, 44233, 46663, 51370, 52582, 51906, 58421, 54486, 58857, 60433, 59469, 61030, 63391, 62153, 61840, 64357, 63495, 63375, 65384, 65535, 64804, 65535, 63310, 65535, 63618, 63529, 64238, 59673, 59042, 58527, 60256, 59630, 52601, 53893, 49605, 50481, 50075, 43580, 43899, 45809, 40198, 37469, 36822, 32584, 32051, 29598, 28804, 24893, 23228, 24149, 23351, 19896, 14019, 16674, 12845, 12817, 10434, 9259, 6937, 3557, 7260, 7151, 2931, 1807, 0, 0, 1063, 0, 1976, 193, 0, 0, 3779, 578, 0, 827, 5617, 810, 2247, 8893, 10394, 8175, 10748, 10535, 10633, 14356, 18984, 21374, 17525, 22263, 25807, 27043, 27752, 28844, 31901, 32750, 35985, 36181, 40137, 39915, 43387, 47577, 50277, 49654, 54915, 54700, 52174, 56789, 59742, 61038, 60087, 59933, 59779, 64413, 63698, 61777, 64812, 64744, 63252, 62662, 64455, 62690, 63730, 63222, 63628, 65535, 61336, 61832, 59411, 60768, 56090, 57673, 52610, 55405, 55177, 47355, 46665, 47575, 46289, 40063, 43029, 41949, 39350, 34475, 35999, 28535, 30872, 27308, 23379, 22587, 19572, 21609, 14972, 15203, 15614, 14099, 7122, 7788, 9132, 3972, 6872, 7212, 1881, 0, 0, 3535, 447, 1499, 0, 0, 1785, 397, 0, 2140, 1883, 3492, 438, 5834, 7007, 3198, 9089, 7848, 7658, 12326, 11872, 12855, 15147, 20694, 20852, 25897, 21511, 28848, 30246, 30541, 32281, 36747, 35067, 37186, 41813, 40610, 48073, 45713, 51533, 51693, 52663, 55308, 52760, 56256, 57019, 62164, 59336, 63902, 61721, 64847, 64121, 63512, 65535, 65535, 63819, 65535, 64291, 63301, 65535, 64081, 65535, 65535, 60744, 62328, 60821, 61948, 56342, 55085, 55913, 52971, 54308, 53158, 49051, 49104, 45022, 46076, 39289, 38936, 35023, 36305, 32108, 31119, 27609, 26703, 22605, 22183, 20235, 19166, 15675, 12137, 10578, 11094, 12662, 7191, 7243, 4724, 6536, 6602, 5203, 0, 1980, 3501, 0, 0, 0, 2661, 1423, 1895, 2888, 3709, 4399, 953, 2994, 3288, 4627, 3927, 4323, 8119, 7103, 10879, 10703, 16076, 16937, 16130, 22779, 20391, 21878, 26768, 26362, 27914, 34808, 32527, 37575, 37596, 37720, 39658, 46903, 43477, 49448, 48151, 49390, 51195, 57889, 57351, 55730, 58601, 62634, 61753, 61576, 64621, 65535, 64574, 64685, 65535, 65535, 64498, 62977, 65535, 65535, 65535, 65535, 64959, 65192, 60911, 57666, 61665, 58501, 57838, 55796, 56908, 53501, 47429, 47321, 47044, 43599, 40057, 39229, 37782, 34433, 34541, 31974, 28429, 27818, 25329, 22509, 23768, 23930, 18436, 14914, 13343, 12050, 12147, 7291, 8345, 10587, 6698, 3312, 1146, 4565, 4692, 4271, 0, 3821, 0, 2277, 1328, 0, 2329, 0, 3623, 2404, 783, 357, 4204, 8297, 3333, 8015, 6142, 13561, 9216, 10646, 14001, 18376, 17112, 18163, 22905, 21825, 27355, 26989, 29474, 35539, 33678, 36131, 41877, 42529, 44994, 46106, 45319, 46388, 49222, 49621, 50922, 52689, 53802, 56761, 56190, 63287, 60408, 64487, 60512, 65535, 64053, 63159, 64417, 62679, 62642, 65535, 65535, 65535, 65535, 65535, 61253, 59984, 63185, 61195, 58451, 59793, 58176, 57527, 53501, 49324, 49474, 50260, 44618, 42565, 45515, 37953, 38625, 39877, 36583, 33825, 32095, 30675, 27309, 26682, 20071, 18169, 16740, 13766, 14564, 13103, 11422, 8193, 10392, 6332, 8379, 5410, 4337, 6356, 1573, 4179, 1684, 0, 0, 1662, 0, 1854, 3491, 754, 0, 1300, 4023, 4550, 7111, 7235, 4754, 7226, 11777, 8853, 11070, 12363, 14617, 19642, 21777, 17835, 23187, 25156, 28545, 31651, 31524, 35742, 34984, 36079, 41769, 43570, 43301, 46445, 45739, 47117, 53062, 53218, 53332, 54483, 58380, 55339, 62108, 61479, 63905, 61374, 63470, 62825, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 62705, 62987, 63015, 65535, 64472, 63916, 59870, 59323, 60156, 58599, 56705, 50486, 49817, 53210, 47122, 46429, 46827, 43300, 40963, 41113, 40002, 37045, 31684, 28922, 31169, 23570, 22697, 20048, 20169, 19157, 18715, 13943, 13251, 10305, 7418, 10190, 10612, 3364, 8174, 4984, 2565, 5472, 0, 2274, 0, 0, 0, 0, 0, 3520, 0, 1858, 0, 493, 2132, 6390, 6282, 8737, 9320, 6445, 12585, 8773, 12673, 13934, 15202, 20540, 22228, 25761, 22733, 24996, 26362, 30450, 32113, 36687, 38755, 39355, 40513, 41299, 42201, 48161, 51812, 53422, 53554, 51255, 56030, 57444, 61045, 56169, 57741, 62791, 60589, 60204, 64607, 65535, 63775, 63773, 65535, 63082, 65535, 65535, 64333, 64571, 64300, 61189, 65535, 60983, 60300, 61711, 59883, 57528, 56009, 55853, 54114, 48056, 47595, 48525, 41755, 40990, 40405, 37743, 39512, 34414, 32735, 29150, 31232, 27143, 23508, 23120, 19350, 16281, 17198, 13789, 15263, 13765, 12834, 9848, 9761, 8951, 8290, 4144, 4336, 4177, 0, 0, 0, 0, 0, 0, 1234, 0, 1503, 0, 4529, 0, 5221, 887, 3759, 9394, 8520, 9884, 7233, 10180, 14606, 12176, 19739, 21469, 22169, 20224, 23963, 26255, 29801, 27454, 31672, 36372, 35336, 40390, 39933, 41254, 45596, 49806, 45800, 48583, 52624, 54874, 56725, 59916, 60814, 61431, 62973, 59254, 61859, 59965, 63724, 62556, 65535, 65535, 65535, 65535, 64792, 65535, 65535, 65514, 62684, 61513, 63291, 63038, 58204, 59290, 55827, 56313, 55780, 52439, 55043, 48834, 51805, 43988, 46915, 42578, 38978, 40536, 33849, 34487, 35855, 32517, 28237, 29237, 27825, 23634, 18515, 17446, 16687, 12029, 14146, 11797, 9809, 7298, 6579, 8799, 6713, 4029, 3577, 5346, 0, 4235, 2456, 0, 1079, 2744, 853, 259, 0, 1114, 1158, 0, 1880, 3410, 6150, 6841, 7992, 9042, 7471, 9661, 10883, 14431, 18470, 20003, 21375, 23280, 26207, 27545, 26663, 29157, 32171, 33200, 39949, 38723, 38798, 42801, 46183, 45102, 49707, 53225, 54857, 55290, 58282, 54673, 58790, 58780, 58041, 60870, 60295, 64240, 64919, 62832, 65535, 65535, 65535, 63945, 65535, 65535, 62345, 63865, 65535, 62950, 63121, 59464, 60593, 60270, 60090, 58403, 52961, 54285, 53573, 51383, 48860, 45641, 46660, 42710, 39073, 37672, 35836, 33561, 33846, 27929, 27165, 27364, 23400, 19500, 22930, 20581, 19398, 17708, 13403, 9770, 8693, 9223, 10775, 4004, 4066, 4028, 1493, 3778, 1628, 4169, 0, 1202, 290, 2065, 414, 0, 622, 2751, 1790, 33, 5819, 5210, 4512, 4923, 6035, 10877, 9716, 14658, 14565, 17014, 18371, 20676, 20232, 24391, 24245, 26696, 27945, 28644, 32589, 36268, 35790, 39694, 39158, 40492, 45596, 48694, 51291, 50421, 51714, 56850, 52966, 57962, 57615, 56305, 58365, 61054, 62793, 63072, 65535, 65089, 61968, 65535, 65535, 65535, 63514, 63964, 61819, 65535, 65535, 62828, 62923, 62799, 59312, 62176, 59843, 57594, 56498, 53022, 51957, 52320, 47439, 48011, 44085, 41033, 44061, 39672, 37520, 34705, 29581, 31655, 29673, 23592, 25214, 24897, 22280, 20383, 19529, 12378, 14110, 10482, 8105, 6389, 5284, 7766, 3539, 5544, 238, 1986, 0, 3550, 1020, 747, 0, 0, 1123, 3313, 0, 998, 4258, 1457, 370, 1542, 5917, 3352, 5776, 10591, 8419, 9477, 15589, 16586, 18419, 21596, 20175, 23991, 22153, 26250, 30995, 33824, 32653, 34795, 36113, 39128, 40238, 42910, 43562, 46540, 46562, 47608, 51301, 53484, 52351, 54797, 57483, 58233, 63202, 61300, 59834, 60232, 65535, 62137, 65535, 63907, 65535, 65535, 65535, 65535, 65535, 65535, 64501, 61755, 64618, 64276, 61115, 59231, 59349, 53819, 55998, 54662, 52235, 51999, 45521, 45089, 45321, 41038, 41981, 36759, 40125, 33268, 30891, 32692, 31134, 23414, 24413, 22024, 18037, 16308, 20213, 13929, 10584, 12708, 9442, 10539, 4481, 6134, 3405, 1726, 0, 0, 1771, 3122, 0, 3254, 0, 0, 2020, 212, 3220, 2058, 0, 4944, 3679, 1672, 2319, 9215, 4552, 6194, 7092, 11214, 15065, 16081, 19858, 21933, 18627, 22491, 27296, 25008, 26663, 33415, 30094, 33752, 38506, 41857, 38850, 46073, 42534, 48829, 49123, 52942, 52161, 53969, 54116, 55750, 56168, 60040, 60470, 62544, 61267, 65289, 62356, 63105, 65535, 65403, 65071, 65535, 65023, 65535, 63820, 62247, 64320, 64375, 60515, 63160, 58238, 57423, 56352, 55677, 55421, 52475, 49371, 53331, 48242, 48795, 42555, 46152, 39400, 37308, 36179, 34228, 30327, 29477, 25832, 23682, 22886, 25439, 20007, 20405, 17535, 14243, 14367, 12191, 12563, 11724, 10544, 8962, 3111, 3906, 5315, 585, 0, 1420, 2233, 875, 0, 1432, 2437, 2044, 1656, 2628, 2743, 1503, 4091, 5997, 3550, 7583, 5152, 11016, 12144, 15101, 11069, 16807, 16025, 17159, 19903, 25041, 24728, 28893, 25804, 27448, 31520, 35392, 39609, 41900, 43687, 41509, 46598, 47449, 50605, 48640, 50364, 54822, 54125, 57835, 54830, 58131, 62557, 64550, 62950, 65510, 60746, 63437, 65356, 64054, 65260, 63447, 63451, 65535, 64672, 65535, 65535, 65506, 59913, 64353, 62784, 61255, 59050, 57131, 56527, 53722, 51022, 52775, 48928, 49188, 41781, 44062, 41696, 36174, 35310, 34029, 32235, 29466, 27027, 25469, 24765, 19786, 23437, 18860, 19899, 16119, 10907, 8766, 7922, 11356, 10163, 5796, 4004, 2056, 1025, 3279, 49, 1217, 0, 3013, 320, 0, 2644, 1151, 1117, 0, 1907, 1215, 2274, 831, 2912, 9247, 6243, 5945, 8394, 11464, 15224, 14867, 17186, 21273, 23177, 23039, 26765, 28637, 29259, 28935, 32328, 37185, 35532, 37983, 43728, 41668, 43571, 46528, 48658, 48245, 54756, 56178, 53152, 55143, 57498, 62318, 57932, 58830, 60079, 64279, 60918, 65535, 65535, 65535, 64011, 63081, 65535, 65535, 62427, 65535, 64308, 64163, 64850, 61047, 58723, 59630, 59130, 56821, 57858, 52426, 50609, 49243, 51790, 43559, 47188, 43477, 42476, 36821, 37347, 31897, 33063, 28984, 28040, 24431, 24049, 19974, 23757, 21852, 15104, 16371, 15162, 10283, 8172, 10675, 6721, 6469, 2544, 937, 1964, 5174, 789, 0, 0, 0, 0, 0, 0, 784, 3113, 0, 3647, 3522, 4661, 4406, 4790, 9341, 9874, 10467, 9424, 11620, 14131, 17605, 19012, 20953, 20193, 22301, 23357, 26163, 27632, 32617, 32591, 35828, 38438, 40198, 42897, 42502, 46297, 46888, 49098, 49084, 54571, 53235, 58287, 55875, 59988, 60443, 58634, 63304, 59280, 62211, 62761, 63413, 63849, 65535, 63285, 63616, 64539, 64596, 65535, 65535, 65535, 61460, 59558, 59704, 57240, 57079, 57520, 53975, 52063, 55180, 49086, 48036, 49300, 44939, 47366, 43778, 37646, 38042, 35677, 38089, 34880, 31854, 29033, 27386, 24918, 20254, 23224, 16017, 16857, 15416, 15587, 12935, 8456, 10592, 10213, 5125, 6338, 3191, 3783, 3905, 0, 0, 1942, 0, 0, 2887, 2209, 323, 0, 2184, 553, 487, 4570, 1024, 7321, 4931, 6318, 11683, 9020, 9801, 16044, 15962, 18096, 17824, 20184, 22353, 23067, 29206, 27690, 29896, 33670, 35880, 35963, 37961, 42628, 41306, 47387, 44934, 46666, 47306, 53918, 51336, 53342, 55690, 60011, 62325, 61527, 61858, 64882, 61681, 65535, 64971, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 64373, 61403, 65001, 65366, 62198, 63541, 56649, 58110, 59308, 53841, 50477, 52220, 50029, 49753, 46540, 46866, 40027, 39618, 41359, 34496, 37113, 33646, 28274, 29673, 26108, 26735, 21950, 22578, 19256, 17172, 17712, 13034, 14740, 11001, 9806, 6585, 6097, 5787, 4551, 1421, 0, 0, 0, 1013, 903, 3310, 0, 132, 647, 0, 0, 1312, 4113, 3344, 5134, 3466, 3194, 10171, 11004, 11854, 14829, 12176, 12029, 17650, 21158, 18499, 21279, 27146, 28077, 26175, 27941, 30398, 37575, 34284, 36929, 38324, 39855, 42753, 48401, 51788, 50714, 52965, 55329, 56652, 58012, 59495, 58564, 57307, 63690, 59602, 62497, 64456, 63420, 63675, 65120, 63015, 64939, 62359, 65535, 65535, 61432, 65535, 63333, 63611, 59837, 62853, 59668, 55381, 56451, 52270, 52899, 54731, 47632, 46498, 46965, 47972, 44891, 39032, 39746, 35842, 34793, 32016, 33581, 29079, 25706, 23405, 25299, 21650, 18758, 13929, 15287, 13626, 9538, 12588, 8563, 5757, 3004, 7844, 3683, 2223, 1107, 944, 2183, 0, 1854, 1822, 1113, 0, 0, 0, 2355, 1096, 3344, 4789, 4053, 1829, 7809, 8638, 9897, 11288, 12727, 10528, 16619, 18874, 19453, 21904, 20074, 22899, 26881, 28835, 32350, 30199, 32350, 36849, 37726, 42942, 41101, 42718, 43500, 50134, 51271, 54653, 53835, 57915, 58495, 56643, 59138, 62617, 63517, 60155, 64602, 61495, 65535, 65102, 65535, 65535, 64206, 65535, 63172, 62045, 65535, 65535, 62009, 65277, 62901, 63331, 58512, 60209, 59047, 56944, 56358, 52599, 51863, 46602, 47897, 47240, 42332, 41427, 40860, 39399, 32662, 31004, 31718, 27761, 28430, 25896, 19770, 21601, 19331, 19586, 17464, 14539, 14342, 10030, 7291, 5033, 3275, 7192, 2737, 5786, 4987, 1509, 0, 0, 0, 0, 612, 0, 1228, 0, 0, 0, 1285, 1539, 4315, 5587, 7407, 6385, 10068, 8859, 12505, 10483, 17332, 19845, 19128, 23772, 19959, 21965, 26336, 27311, 32270, 34400, 34236, 37793, 36953, 43759, 43746, 44951, 45237, 47625, 53185, 53015, 53727, 57531, 57658, 58952, 60198, 61687, 58517, 59884, 60740, 64650, 62229, 65535, 65535, 65535, 65535, 63831, 64923, 65535, 65535, 62218, 60957, 62937, 63266, 61390, 57607, 60436, 54985, 53593, 53085, 49069, 53514, 49119, 44480, 44567, 44622, 42958, 38338, 33769, 34705, 31279, 27563, 29612, 25668, 24635, 22261, 21471, 15774, 18417, 16030, 11995, 12756, 12627, 10349, 9749, 6463, 5049, 5213, 4225, 4158, 3105, 4299, 2149, 0, 0, 1168, 0, 0, 0, 0, 3623, 1598, 3785, 4774, 4435, 9314, 7795, 7766, 7144, 14850, 16463, 13801, 17563, 17818, 22111, 24951, 27881, 28009, 28272, 31173, 34972, 34193, 35177, 36572, 43322, 40481, 46153, 47596, 49682, 52254, 52228, 54510, 53226, 59538, 56085, 56362, 60247, 62707, 63897, 60895, 65535, 65252, 65535, 65535, 65535, 65535, 65535, 65520, 64036, 62314, 62709, 64735, 65064, 62019, 58105, 60909, 54817, 59492, 51963, 55278, 49216, 47931, 47456, 44383, 42421, 42948, 43133, 40255, 39309, 36870, 30405, 29134, 27238, 29614, 26935, 21545, 22562, 21562, 16374, 14411, 14131, 9271, 12812, 6617, 6827, 8376, 8251, 3643, 2296, 4665, 3356, 2494, 803, 0, 2437, 2029, 0, 2231, 310, 3300, 1118, 605, 3315, 1965, 1893, 3318, 10075, 10353, 8844, 8769, 14703, 13884, 14261, 20656, 22522, 19791, 23199, 27308, 28048, 32789, 34067, 32905, 39885, 39918, 39208, 41234, 43549, 45955, 48851, 49532, 51880, 50526, 53357, 55052, 60136, 60914, 59902, 62824, 59549, 65028, 64269, 62366, 65535, 62819, 63125, 62862, 64801, 65476, 64349, 65265, 65535, 60266, 62438, 59184, 60272, 62302, 56104, 56988, 52357, 50429, 55058, 48383, 48540, 43871, 42705, 42954, 39512, 36090, 33797, 32217, 34244, 30114, 25632, 29827, 24300, 22439, 23057, 19774, 19463, 14866, 13990, 9993, 7304, 6838, 9610, 6151, 8301, 3147, 2814, 720, 1466, 0, 2424, 0, 0, 2803, 759, 2146, 1934, 3770, 2568, 0, 579, 2692, 6409, 6507, 7025, 11460, 10737, 14362, 12128, 13409, 20096, 19492, 18308, 23407, 22662, 29093, 26621, 32417, 29810, 36617, 35221, 42115, 39297, 40623, 42308, 46201, 51005, 50526, 51059, 51032, 52049, 53589, 59006, 59978, 60822, 61746, 61090, 63488, 65481, 65535, 64211, 63370, 64481, 65535, 65535, 63187, 65535, 65301, 61642, 65535, 65015, 59842, 57830, 57875, 55072, 56506, 55877, 54786, 50375, 50053, 51712, 44277, 44811, 41709, 40441, 40000, 34324, 37149, 33696, 31857, 25582, 25548, 26031, 19727, 18537, 18378, 14570, 17977, 10559, 10538, 8744, 6156, 10568, 7205, 8142, 3456, 3096, 0, 114, 1937, 0, 0, 0, 1160, 0, 0, 0, 2553, 3063, 0, 5069, 6970, 7024, 4332, 6094, 8424, 9562, 13835, 10431, 12857, 15604, 18408, 23142, 22256, 22072, 27428, 29140, 32971, 29867, 35032, 34299, 37858, 39022, 40317, 44847, 43991, 49569, 49478, 50159, 53293, 53313, 55654, 54883, 60600, 58478, 64218, 60946, 62335, 64703, 65220, 64601, 65535, 62440, 62343, 65210, 65504, 64401, 62351, 61040, 60458, 60250, 62221, 63162, 59046, 59127, 55634, 52720, 51652, 53923, 47197, 45277, 47973, 43137, 45703, 40362, 40913, 37456, 36902, 33900, 29206, 26265, 27369, 24759, 21738, 21811, 20892, 16934, 14147, 13913, 12349, 12393, 9106, 8852, 7627, 6383, 6651, 1435, 3030, 0, 4150, 0, 0, 1066, 936, 2575, 0, 2239, 0, 0, 996, 1966, 3334, 5827, 3980, 9033, 9095, 8489, 14285, 16244, 13164, 16876, 19052, 20399, 23071, 26575, 24649, 28739, 33799, 34298, 35538, 37149, 41893, 43363, 44365, 43809, 44833, 45598, 51437, 55131, 53724, 58298, 56314, 56091, 59672, 57707, 60253, 61309, 62323, 61188, 63241, 65535, 62914, 65535, 65535, 65535, 65535, 63226, 61708, 62532, 63457, 59769, 63755, 62990, 61812, 57484, 57444, 52022, 55466, 53450, 51365, 49993, 44417, 45563, 45713, 40821, 39182, 39186, 32682, 31685, 29244, 30102, 25719, 26277, 20626, 19131, 20559, 17706, 14894, 11351, 12069, 9734, 10954, 7193, 4023, 2351, 6678, 4431, 0, 4488, 1584, 2849, 3093, 2766, 576, 0, 0, 3332, 2359, 1429, 0, 5825, 6575, 6084, 3642, 7463, 10026, 10384, 12917, 15615, 17347, 18254, 19111, 19199, 21059, 26088, 27158, 26441, 30785, 33715, 37066, 36876, 40872, 39855, 43001, 42837, 45327, 49353, 49672, 49447, 54790, 54716, 57607, 55698, 59439, 57994, 58978, 65517, 60246, 65011, 65216, 65535, 65535, 64283, 65535, 65535, 65535, 65535, 64568, 61687, 64277, 62904, 62847, 62815, 59628, 58667, 58229, 52104, 52942, 49576, 50725, 50141, 47577, 44540, 42664, 40053, 37427, 36335, 33778, 33523, 33388, 27379, 27324, 21980, 22225, 21868, 16699, 17582, 12577, 13232, 13001, 12723, 6335, 7487, 3253, 2631, 5536, 2126, 2524, 1442, 2789, 2652, 0, 324, 2595, 0, 3457, 2101, 317, 1363, 0, 5473, 1347, 2988, 4082, 5471, 8006, 13167, 14714, 13500, 15861, 14394, 21824, 23850, 25126, 21428, 27248, 30975, 32863, 33693, 34193, 37113, 36728, 38427, 40324, 45422, 45778, 50956, 50594, 52601, 55117, 53173, 57811, 58219, 59981, 60186, 63268, 61730, 65535, 61196, 65413, 65418, 65535, 65535, 63213, 65153, 64903, 65535, 65535, 65535, 64123, 60069, 63052, 59601, 59722, 59452, 56200, 57237, 54957, 54151, 51788, 45927, 43718, 46096, 41242, 40366, 38289, 37404, 33329, 32005, 29510, 26177, 27390, 26206, 21392, 20148, 18087, 18097, 13602, 12523, 13275, 13157, 6863, 7521, 3272, 7607, 1439, 4229, 1479, 703, 3929, 1458, 0, 1966, 2379, 260, 1552, 1638, 2523, 0, 2259, 5867, 1114, 6125, 9322, 7899, 8807, 9637, 10540, 13116, 15695, 15086, 16481, 23962, 21423, 22453, 27464, 29936, 30040, 30565, 33709, 37731, 41297, 39077, 40410, 44961, 48430, 47231, 49832, 54292, 52923, 55897, 53912, 57437, 62504, 62956, 59100, 64106, 60064, 63056, 61985, 64847, 62184, 65535, 65535, 65025, 62509, 64028, 63190, 63533, 64038, 64312, 58987, 57442, 57297, 61047, 55438, 54316, 51617, 54712, 49090, 48034, 47546, 42922, 45717, 40337, 41078, 34762, 36335, 31700, 27700, 26979, 26474, 25603, 20397, 17805, 19102, 18716, 15514, 15017, 12366, 13259, 9942, 9563, 8057, 7723, 3903, 3981, 3091, 3400, 0, 464, 0, 2957, 3009, 0, 0, 2656, 3748, 0, 2121, 5597, 2248, 3338, 8676, 10579, 9434, 9849, 13590, 10903, 15145, 16954, 18256, 19055, 25137, 26764, 29726, 30597, 33257, 31330, 35131, 38257, 39649, 39154, 39650, 42026, 43966, 50610, 51349, 50701, 55971, 52693, 56754, 54937, 59832, 63483, 60182, 64729, 65058, 65003, 62986, 65535, 65535, 65535, 65535, 64482, 65535, 61952, 65535, 65535, 62150, 61705, 62529, 62413, 59615, 55994, 56532, 52906, 54773, 54245, 52362, 49442, 48230, 47236, 44366, 39383, 36538, 36672, 33230, 35227, 29625, 29201, 28075, 27143, 24877, 19098, 16057, 19609, 16983, 13693, 9742, 7362, 9176, 8875, 5634, 2339, 1691, 1221, 4103, 0, 2811, 3128, 0, 2542, 0, 0, 0, 0, 3769, 3156, 4272, 4828, 3173, 2302, 9197, 8881, 6339, 7279, 13030, 12862, 14587, 20114, 18808, 20638, 24460, 21863, 29756, 30665, 27461, 31698, 37197, 34777, 41889, 39679, 43285, 41809, 45630, 49581, 50925, 54020, 54032, 54373, 55110, 56891, 57013, 59576, 64072, 63381, 63441, 61342, 64639, 63866, 65535, 64411, 65535, 65535, 62793, 65535, 63527, 64334, 62178, 60729, 60843, 59525, 57779, 55517, 54318, 55277, 55450, 51182, 49964, 50473, 47221, 45601, 45090, 41550, 36909, 38381, 36078, 33971, 30991, 25467, 29648, 22681, 21470, 22743, 18203, 14014, 12796, 12095, 11850, 11564, 8833, 10152, 3248, 2302, 1449, 1113, 2787, 103, 0, 3551, 2140, 1483, 0, 2593, 1539, 1739, 3765, 4082, 808, 3999, 6852, 3920, 6254, 7447, 10954, 11724, 14396, 13817, 17966, 16067, 20943, 19119, 21113, 22760, 24285, 31153, 29219, 35831, 32222, 37445, 36575, 43936, 39810, 42813, 47490, 49136, 47577, 54718, 54745, 52513, 54568, 56105, 58882, 61715, 59353, 60107, 65375, 65461, 64645, 65535, 65535, 63028, 64026, 64769, 64605, 63135, 62092, 60718, 61118, 62598, 59477, 57583, 60873, 58871, 55248, 54504, 53355, 52284, 52438, 50330, 44328, 43782, 45067, 39761, 42183, 35174, 37144, 32547, 32985, 27013, 28561, 25647, 21340, 18347, 19266, 20075, 15936, 16048, 10477, 11522, 9016, 6086, 3312, 5206, 7323, 433, 1105, 0, 0, 2638, 0, 0, 0, 929, 0, 0, 2461, 315, 1611, 5353, 6432, 5584, 6336, 6155, 11648, 13317, 9984, 16009, 16725, 18594, 20053, 17950, 23666, 26983, 25838, 25655, 30861, 30793, 32903, 39721, 37459, 42520, 41173, 44254, 46739, 45621, 48632, 50609, 50619, 56820, 56086, 60549, 59735, 60287, 58247, 64946, 60162, 65535, 62154, 65535, 65535, 65535, 65535, 65535, 62445, 65535, 65532, 61709, 64566, 62388, 60014, 63657, 56747, 58406, 53426, 54324, 52796, 54080, 51588, 51562, 47683, 46010, 43001, 41581, 42078, 34661, 32068, 33763, 29591, 26142, 24864, 22799, 23580, 19207, 17652, 16392, 14781, 16303, 11984, 13033, 11414, 7082, 7232, 6520, 6191, 1883, 2816, 0, 2912, 2124, 1164, 0, 378, 0, 691, 0, 850, 392, 4100, 2645, 1440, 7867, 6637, 10051, 9228, 8083, 14753, 13312, 17749, 14494, 17898, 18164, 20435, 26623, 25687, 28867, 27574, 32035, 37963, 35683, 37130, 41621, 43932, 44873, 46528, 50844, 51349, 48781, 54142, 52536, 55211, 56465, 60787, 63131, 60253, 61874, 61473, 60852, 62864, 63695, 63362, 65535, 63313, 65535, 64853, 63691, 63097, 64148, 63978, 64813, 59514, 58497, 57774, 55374, 56311, 54615, 56393, 53943, 50509, 50152, 45219, 46716, 45828, 41579, 38207, 38913, 32231, 31133, 29817, 27675, 25463, 25908, 21154, 19402, 22091, 14118, 13081, 13344, 11111, 12988, 9434, 9298, 3994, 7742, 3062, 3430, 2090, 1832, 1585, 3594, 0, 3102, 0, 1246, 0, 0, 0, 596, 3934, 3410, 6898, 3496, 3197, 9936, 11553, 12545, 11123, 12622, 13100, 15082, 18326, 17848, 20034, 21458, 26358, 31496, 27916, 32138, 34366, 35497, 41173, 43655, 44785, 47776, 48278, 48589, 52608, 53295, 52711, 57727, 56661, 59257, 57843, 61290, 59290, 61980, 60829, 63209, 65535, 64823, 64905, 64063, 65508, 63810, 63285, 64899, 61762, 61484, 60739, 64510, 58907, 62951, 60284, 60336, 55624, 52352, 53360, 50362, 53132, 48421, 47950, 46380, 45016, 43373, 35938, 39643, 35368, 31676, 30617, 30804, 26188, 24826, 22675, 22185, 20126, 13941, 12800, 10265, 14883, 11882, 11357, 10730, 4885, 6832, 6582, 5811, 5014, 106, 745, 2553, 0, 0, 2911, 2955, 2725, 1334, 0, 1791, 0, 2971, 6783, 6809, 9182, 4750, 10583, 9214, 14290, 16311, 13004, 18833, 18718, 20658, 22283, 26526, 26843, 27140, 30285, 33722, 33665, 38920, 36575, 41096, 41337, 46606, 47210, 50597, 48474, 51703, 54976, 52543, 56393, 56133, 56825, 58078, 61711, 62873, 62010, 62391, 65535, 63188, 65535, 65535, 65535, 65535, 63607, 65535, 62932, 65235, 62499, 60894, 63498, 57656, 56575, 59946, 55722, 51933, 55501, 53048, 47338, 46939, 46944, 46206, 42246, 42852, 39476, 34411, 34018, 35860, 28727, 25750, 26360, 25083, 19943, 21056, 21696, 15656, 13458, 13896, 13835, 10526, 7300, 5208, 8055, 5009, 5739, 1496, 1236, 93, 0, 0, 0, 995, 2076, 0, 2579, 0, 2098, 641, 3479, 1872, 6028, 6697, 8596, 5745, 8057, 11234, 12494, 14624, 12318, 19144, 21836, 17449, 24032, 22003, 26741, 31711, 28736, 32680, 34938, 34012, 38103, 37959, 45934, 47590, 44029, 51766, 52113, 53599, 56801, 58410, 53555, 56720, 61158, 57681, 59604, 62703, 61698, 64005, 65535, 64348, 65535, 65535, 65291, 63130, 64745, 63959, 63415, 63992, 62282, 64796, 64642, 59022, 60131, 57389, 58394, 53860, 53330, 49417, 48246, 46713, 48187, 44981, 42703, 38904, 41012, 36588, 37098, 31244, 29616, 31559, 29671, 24896, 24955, 18184, 20700, 14730, 12603, 13790, 10496, 10164, 9832, 7345, 4386, 7544, 7234, 2776, 0, 314, 2992, 0, 3087, 0, 2426, 0, 0, 1336, 2078, 0, 1742, 3996, 4803, 2205, 8257, 9527, 9987, 11498, 9351, 15868, 13613, 18785, 15859, 21578, 23796, 23014, 28974, 30787, 29265, 35086, 37994, 39556, 37409, 38349, 42214, 41777, 47555, 46063, 47557, 53175, 52055, 53471, 54136, 56473, 58128, 63361, 63266, 64093, 63570, 64426, 62765, 62870, 65535, 65430, 63390, 65535, 65535, 63526, 63792, 62432, 64841, 64990, 61448, 63579, 57807, 58430, 56454, 54988, 55711, 50844, 49994, 51196, 46283, 43816, 43833, 39945, 37174, 34942, 36304, 32950, 31169, 31885, 28881, 27330, 23341, 21918, 19498, 13903, 13461, 16336, 12759, 8237, 10487, 5348, 4101, 2912, 7017, 1663, 2675, 1246, 0, 1296, 1330, 708, 0, 0, 865, 402, 2387, 2229, 4369, 5173, 3448, 2189, 5419, 5685, 8423, 11237, 10828, 11505, 17212, 15598, 18359, 18311, 25669, 24131, 23383, 30720, 30102, 33800, 33625, 39487, 39523, 40033, 39953, 45327, 49165, 49114, 50301, 51181, 50891, 58220, 55038, 55626, 56007, 60369, 59487, 61044, 65535, 65535, 65535, 64272, 65535, 62326, 62586, 65535, 65535, 64307, 65535, 65320, 65535, 59427, 63506, 62457, 57729, 56487, 57664, 56507, 52800, 54494, 48818, 47444, 45684, 45868, 40337, 41878, 39439, 38253, 32526, 32797, 28917, 31724, 26545, 25813, 24144, 23004, 19106, 17846, 16015, 10463, 12258, 8348, 11734, 4732, 7312, 2859, 6861, 2116, 5315, 279, 3454, 1096, 3366, 2382, 2821, 0, 2597, 290, 3584, 1972, 225, 811, 2297, 3685, 8805, 9463, 9360, 7819, 14916, 14420, 15493, 18824, 20752, 20367, 21154, 21942, 27228, 27658, 30051, 35509, 33364, 34273, 36979, 40665, 43494, 42330, 47039, 50505, 53190, 50951, 51366, 56363, 55937, 59525, 60861, 57476, 60266, 63728, 65535, 64530, 61781, 63203, 65126, 65535, 62810, 65427, 62727, 62859, 63269, 65535, 61378, 59726, 63528, 57836, 57067, 60328, 57532, 56740, 52141, 54783, 48564, 49578, 44441, 45698, 40417, 39891, 40604, 35752, 31589, 32876, 31010, 31833, 27394, 24355, 24055, 21131, 15625, 15937, 12813, 13574, 12390, 8133, 8625, 9373, 6722, 7749, 4009, 302, 4785, 4768, 0, 0, 800, 3016, 1735, 997, 0, 0, 2475, 0, 0, 934, 1201, 3633, 3391, 10417, 11587, 8198, 12148, 15051, 12125, 19764, 15631, 21534, 24630, 25509, 24752, 30368, 31151, 30887, 36456, 36755, 40249, 37992, 45549, 46905, 45227, 46554, 51368, 48945, 52149, 57909, 56196, 57039, 56110, 61346, 59914, 60555, 62211, 63012, 65535, 64941, 65535, 64204, 65535, 63342, 63733, 64412, 63453, 62309, 65417, 63146, 64550, 60635, 56078, 55654, 54940, 56444, 51979, 54806, 51013, 49433, 46308, 41768, 45749, 41277, 36479, 38812, 32464, 33042, 30764, 31228, 28284, 27194, 25330, 20124, 19793, 19703, 17882, 11232, 14276, 12157, 11873, 5233, 3465, 5802, 5976, 5871, 4975, 4057, 2803, 0, 0, 0, 2974, 0, 2187, 0, 1297, 0, 4787, 768, 2093, 8356, 7185, 7942, 6453, 8178, 13832, 14548, 15346, 13803, 15876, 23429, 20320, 23673, 28587, 31494, 30805, 29552, 35039, 38016, 41314, 38170, 39668, 46277, 49224, 51653, 49886, 50773, 52827, 52253, 56370, 55176, 61108, 59448, 62381, 63842, 63444, 64385, 62247, 64031, 65535, 65535, 62855, 65208, 65302, 65535, 65535, 63280, 65384, 59294, 61930, 62336, 62248, 58115, 57984, 52427, 50830, 49723, 47540, 48695, 48513, 43080, 44525, 43628, 36874, 37717, 32416, 30393, 29063, 28762, 29302, 21586, 22692, 17636, 21191, 18214, 18186, 16415, 14999, 10486, 6135, 4489, 3639, 3496, 5720, 1158, 1861, 4511, 0, 0, 0, 2374, 3081, 2206, 2333, 0, 1506, 331, 1620, 2360, 3114, 4820, 3446, 5292, 7089, 9177, 8801, 11637, 18269, 20030, 20302, 22468, 23444, 23272, 24691, 31033, 28064, 31682, 32514, 38637, 38418, 38764, 44168, 47586, 45928, 46293, 49345, 54555, 53216, 56834, 58826, 55680, 57812, 60661, 63332, 62396, 60189, 63502, 63349, 65535, 65535, 65535, 65535, 63797, 65535, 65535, 62966, 63486, 60283, 63254, 59994, 57590, 60972, 58792, 59373, 53235, 56483, 52822, 48416, 46907, 44958, 45418, 42999, 41932, 40632, 38716, 35128, 34108, 29280, 28809, 29143, 23032, 19734, 17848, 19121, 16928, 15753, 10794, 12454, 10112, 5956, 6789, 9031, 7425, 1517, 3926, 3867, 3435, 3049, 0, 0, 189, 0, 0, 0, 3621, 0, 2821, 2076, 2610, 5543, 3534, 6470, 8947, 7413, 8663, 10808, 13042, 13477, 16014, 20712, 18592, 20621, 24550, 27250, 25528, 30924, 31640, 37271, 37034, 36265, 42211, 41206, 47953, 49296, 50075, 49258, 55239, 56421, 58386, 55998, 58223, 61320, 62746, 61178, 59777, 61415, 65535, 62237, 64631, 65535, 65535, 64298, 64740, 62878, 63580, 64887, 65211, 61471, 60603, 58748, 62996, 61270, 60156, 57008, 54314, 52346, 50415, 53488, 50329, 47245, 43661, 39778, 41668, 35669, 34041, 32213, 30883, 32135, 28412, 27627, 22381, 22680, 23484, 15653, 19024, 17276, 14581, 9634, 8380, 6971, 6269, 6859, 4286, 1907, 2616, 4454, 4126, 2348, 0, 1078, 2119, 0, 2867, 2540, 2985, 2455, 2992, 0, 6043, 1205, 6118, 4539, 4619, 11208, 9403, 10668, 12609, 16701, 18079, 15967, 23918, 21829, 25319, 27094, 25985, 29837, 32266, 33012, 37705, 38074, 42009, 45856, 45670, 46409, 45752, 48423, 55109, 53656, 52776, 54259, 59575, 58934, 63256, 59568, 61784, 62087, 63572, 65535, 63914, 65535, 62616, 62953, 63385, 65370, 65535, 62450, 65535, 63306, 64060, 61862, 61446, 62434, 55379, 57328, 52375, 54097, 50935, 51612, 51722, 49901, 42015, 42223, 41590, 39858, 34731, 37006, 35187, 30741, 31072, 26517, 26006, 21831, 17822, 21127, 17086, 17465, 13249, 14884, 12709, 7751, 10050, 5301, 6907, 6334, 5870, 1638, 0, 1922, 1473, 959, 100, 2540, 0, 0, 0, 4250, 0, 1129, 6004, 5794, 6713, 9052, 6971, 6402, 11215, 10176, 16508, 16511, 16024, 19344, 21522, 23087, 24266, 29142, 25569, 30103, 31193, 37393, 36443, 39262, 40428, 42362, 46258, 47284, 48480, 51004, 51220, 53944, 56522, 54785, 57511, 56515, 57285, 64218, 64451, 65535, 65535, 65535, 65535, 63592, 65535, 62481, 63951, 64031, 65535, 62783, 61729, 60931, 64335, 63752, 62588, 60995, 58564, 54822, 56425, 52405, 53039, 50483, 45819, 44141, 46802, 40595, 38900, 41359, 33808, 36837, 35895, 33022, 29035, 29645, 21660, 21668, 17541, 15819, 17235, 13422, 15429, 11908, 10948, 11532, 4932, 6484, 4875, 5978, 3270, 2103, 0, 315, 0, 2903, 0, 0, 1615, 0, 1011, 3007, 1306, 1589, 2607, 3576, 2921, 5381, 8719, 6122, 8215, 10575, 16741, 13382, 19008, 15932, 17746, 22745, 22795, 27819, 25840, 30534, 32433, 37215, 38643, 41235, 40898, 45695, 45700, 49385, 45352, 53151, 52864, 56334, 55222, 59271, 57654, 61150, 60969, 58894, 61873, 60195, 65535, 64674, 62782, 65535, 63040, 63249, 62589, 65535, 62839, 64298, 65535, 63802, 62538, 59615, 59301, 56961, 57007, 58781, 56892, 56474, 50932, 52000, 45443, 44909, 43531, 39700, 37867, 37604, 37494, 31598, 33753, 32493, 29806, 28862, 21921, 24606, 18709, 21606, 17454, 15172, 11406, 11028, 8164, 6063, 8221, 9390, 4577, 5507, 2331, 2187, 4065, 0, 146, 0, 960, 1675, 1936, 0, 1128, 0, 0, 4135, 0, 7329, 6375, 5105, 4999, 11738, 9911, 10357, 11331, 13170, 14005, 20787, 20296, 25607, 26502, 27064, 25699, 30937
};

int get_feature_data(size_t offset, size_t length, float *out_ptr) {
    memcpy(out_ptr, features + offset, length * sizeof(float));
    return 0;
}
/* USER CODE END Includes */

/* Private typedef -----------------------------------------------------------*/
/* USER CODE BEGIN PTD */

/* USER CODE END PTD */

/* Private define ------------------------------------------------------------*/
/* USER CODE BEGIN PD */

/* USER CODE END PD */

/* Private macro -------------------------------------------------------------*/
/* USER CODE BEGIN PM */

/* USER CODE END PM */

/* Private variables ---------------------------------------------------------*/

UART_HandleTypeDef huart1;

/* USER CODE BEGIN PV */

//Por si teniamos que mandar algo por uart pero nel
//uint8_t atributos[18] = {0}; //datos recibidos
//char *ptr; //puntero para manipular la cadena de caracteres
//int cont = 0; //contador para iterar en el array de features

/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_USART1_UART_Init(void);
/* USER CODE BEGIN PFP */

void func(bool s, float f); //imprime la señal identificada

/* USER CODE END PFP */

/* Private user code ---------------------------------------------------------*/
/* USER CODE BEGIN 0 */
#include <stdarg.h>
#include "edge-impulse-sdk/classifier/ei_run_classifier.h"

void vprint(const char *fmt, va_list argp)
{
    char string[200];
    if(0 < vsprintf(string, fmt, argp)) // build string
    {
        HAL_UART_Transmit(&huart1, (uint8_t*)string, strlen(string), 180); // send message via UART
    }
}

void ei_printf(const char *format, ...) {
    va_list myargs;
    va_start(myargs, format);
    vprint(format, myargs);
    va_end(myargs);
}
/* USER CODE END 0 */

/**
  * @brief  The application entry point.
  * @retval int
  */
int main(void)
{
  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration--------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */
  signal_t signal;
  signal.total_length = sizeof(features) / sizeof(features[0]);
  signal.get_data = &get_feature_data;
  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_USART1_UART_Init();
  /* USER CODE BEGIN 2 */

  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  int i = 0;
  float t = 0.0;
  while (1)
  {
    /* USER CODE END WHILE */

    /* USER CODE BEGIN 3 */
	  ei_impulse_result_t result = { 0 };
	  run_classifier(&signal, &result, false);

	  if (result.classification[0].value < result.classification[1].value) {
		 //ei_printf("triangulo\r\n");
		 func(false,100);
	  }else{
		//ei_printf("seno\r\n");
		func(true,100);
	}

	//generamos señal con ruido nueva ya dio flojera :( Ya no quiero pensar
	/*
	out = 327675.0*sin(2.0*3.1416*t*f) + 327675.0;
	out += rand();//agregamos ruido

	if(out>=65535){
		out = 65535.0;
	}
	if(out<=0) {
		out = 0.0;
	}

	features[i] = out; //Agremamos lo recien calculdo alvector de entrada

	i++;
	t += 0.001;

	if(i>=999){ //se setea a 0
		t = 0.0;
		i = 0;
	}
	*/
  }
  /* USER CODE END 3 */
}

/**
  * @brief System Clock Configuration
  * @retval None
  */
void SystemClock_Config(void)
{
  RCC_OscInitTypeDef RCC_OscInitStruct = {0};
  RCC_ClkInitTypeDef RCC_ClkInitStruct = {0};

  /** Configure the main internal regulator output voltage
  */
  __HAL_RCC_PWR_CLK_ENABLE();
  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE2);

  /** Initializes the RCC Oscillators according to the specified parameters
  * in the RCC_OscInitTypeDef structure.
  */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;
  RCC_OscInitStruct.HSIState = RCC_HSI_ON;
  RCC_OscInitStruct.HSICalibrationValue = RCC_HSICALIBRATION_DEFAULT;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSI;
  RCC_OscInitStruct.PLL.PLLM = 10;
  RCC_OscInitStruct.PLL.PLLN = 210;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 2;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    Error_Handler();
  }

  /** Initializes the CPU, AHB and APB buses clocks
  */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV2;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_5) != HAL_OK)
  {
    Error_Handler();
  }
}

/**
  * @brief USART1 Initialization Function
  * @param None
  * @retval None
  */
static void MX_USART1_UART_Init(void)
{

  /* USER CODE BEGIN USART1_Init 0 */

  /* USER CODE END USART1_Init 0 */

  /* USER CODE BEGIN USART1_Init 1 */

  /* USER CODE END USART1_Init 1 */
  huart1.Instance = USART1;
  huart1.Init.BaudRate = 115200;
  huart1.Init.WordLength = UART_WORDLENGTH_8B;
  huart1.Init.StopBits = UART_STOPBITS_1;
  huart1.Init.Parity = UART_PARITY_NONE;
  huart1.Init.Mode = UART_MODE_TX_RX;
  huart1.Init.HwFlowCtl = UART_HWCONTROL_NONE;
  huart1.Init.OverSampling = UART_OVERSAMPLING_16;
  huart1.Init.OneBitSampling = UART_ONE_BIT_SAMPLE_DISABLE;
  huart1.AdvancedInit.AdvFeatureInit = UART_ADVFEATURE_NO_INIT;
  if (HAL_UART_Init(&huart1) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN USART1_Init 2 */

  /* USER CODE END USART1_Init 2 */

}

/**
  * @brief GPIO Initialization Function
  * @param None
  * @retval None
  */
static void MX_GPIO_Init(void)
{
  GPIO_InitTypeDef GPIO_InitStruct = {0};
/* USER CODE BEGIN MX_GPIO_Init_1 */
/* USER CODE END MX_GPIO_Init_1 */

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOE_CLK_ENABLE();
  __HAL_RCC_GPIOG_CLK_ENABLE();
  __HAL_RCC_GPIOB_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();
  __HAL_RCC_GPIOC_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();
  __HAL_RCC_GPIOJ_CLK_ENABLE();
  __HAL_RCC_GPIOI_CLK_ENABLE();
  __HAL_RCC_GPIOK_CLK_ENABLE();
  __HAL_RCC_GPIOF_CLK_ENABLE();
  __HAL_RCC_GPIOH_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(OTG_FS_PowerSwitchOn_GPIO_Port, OTG_FS_PowerSwitchOn_Pin, GPIO_PIN_SET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOI, ARDUINO_D7_Pin|ARDUINO_D8_Pin|LCD_DISP_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(LCD_BL_CTRL_GPIO_Port, LCD_BL_CTRL_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(DCMI_PWR_EN_GPIO_Port, DCMI_PWR_EN_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOG, ARDUINO_D4_Pin|ARDUINO_D2_Pin|EXT_RST_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin : LCD_B0_Pin */
  GPIO_InitStruct.Pin = LCD_B0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF14_LTDC;
  HAL_GPIO_Init(LCD_B0_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : OTG_HS_OverCurrent_Pin */
  GPIO_InitStruct.Pin = OTG_HS_OverCurrent_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(OTG_HS_OverCurrent_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : QSPI_D2_Pin */
  GPIO_InitStruct.Pin = QSPI_D2_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF9_QUADSPI;
  HAL_GPIO_Init(QSPI_D2_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : RMII_TXD1_Pin RMII_TXD0_Pin RMII_TX_EN_Pin */
  GPIO_InitStruct.Pin = RMII_TXD1_Pin|RMII_TXD0_Pin|RMII_TX_EN_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF11_ETH;
  HAL_GPIO_Init(GPIOG, &GPIO_InitStruct);

  /*Configure GPIO pins : FMC_NBL1_Pin FMC_NBL0_Pin FMC_D5_Pin FMC_D6_Pin
                           FMC_D8_Pin FMC_D11_Pin FMC_D4_Pin FMC_D7_Pin
                           FMC_D9_Pin FMC_D12_Pin FMC_D10_Pin */
  GPIO_InitStruct.Pin = FMC_NBL1_Pin|FMC_NBL0_Pin|FMC_D5_Pin|FMC_D6_Pin
                          |FMC_D8_Pin|FMC_D11_Pin|FMC_D4_Pin|FMC_D7_Pin
                          |FMC_D9_Pin|FMC_D12_Pin|FMC_D10_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_FMC;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pins : ARDUINO_SCL_D15_Pin ARDUINO_SDA_D14_Pin */
  GPIO_InitStruct.Pin = ARDUINO_SCL_D15_Pin|ARDUINO_SDA_D14_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_OD;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF4_I2C1;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pins : ULPI_D7_Pin ULPI_D6_Pin ULPI_D5_Pin ULPI_D3_Pin
                           ULPI_D2_Pin ULPI_D1_Pin ULPI_D4_Pin */
  GPIO_InitStruct.Pin = ULPI_D7_Pin|ULPI_D6_Pin|ULPI_D5_Pin|ULPI_D3_Pin
                          |ULPI_D2_Pin|ULPI_D1_Pin|ULPI_D4_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_OTG_HS;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pin : ARDUINO_PWM_D3_Pin */
  GPIO_InitStruct.Pin = ARDUINO_PWM_D3_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF2_TIM3;
  HAL_GPIO_Init(ARDUINO_PWM_D3_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : SPDIF_RX0_Pin */
  GPIO_InitStruct.Pin = SPDIF_RX0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF8_SPDIFRX;
  HAL_GPIO_Init(SPDIF_RX0_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : SDMMC_CK_Pin SDMMC_D3_Pin SDMMC_D2_Pin PC9
                           PC8 */
  GPIO_InitStruct.Pin = SDMMC_CK_Pin|SDMMC_D3_Pin|SDMMC_D2_Pin|GPIO_PIN_9
                          |GPIO_PIN_8;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_SDMMC1;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pin : ARDUINO_PWM_D9_Pin */
  GPIO_InitStruct.Pin = ARDUINO_PWM_D9_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF1_TIM2;
  HAL_GPIO_Init(ARDUINO_PWM_D9_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : DCMI_D6_Pin DCMI_D7_Pin */
  GPIO_InitStruct.Pin = DCMI_D6_Pin|DCMI_D7_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF13_DCMI;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pin : QSPI_NCS_Pin */
  GPIO_InitStruct.Pin = QSPI_NCS_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_QUADSPI;
  HAL_GPIO_Init(QSPI_NCS_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : FMC_SDNCAS_Pin FMC_SDCLK_Pin FMC_A11_Pin FMC_A10_Pin
                           FMC_BA1_Pin FMC_BA0_Pin */
  GPIO_InitStruct.Pin = FMC_SDNCAS_Pin|FMC_SDCLK_Pin|FMC_A11_Pin|FMC_A10_Pin
                          |FMC_BA1_Pin|FMC_BA0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_FMC;
  HAL_GPIO_Init(GPIOG, &GPIO_InitStruct);

  /*Configure GPIO pins : LCD_B1_Pin LCD_B2_Pin LCD_B3_Pin LCD_G4_Pin
                           LCD_G1_Pin LCD_G3_Pin LCD_G0_Pin LCD_G2_Pin
                           LCD_R7_Pin LCD_R5_Pin LCD_R6_Pin LCD_R4_Pin
                           LCD_R3_Pin LCD_R1_Pin LCD_R2_Pin */
  GPIO_InitStruct.Pin = LCD_B1_Pin|LCD_B2_Pin|LCD_B3_Pin|LCD_G4_Pin
                          |LCD_G1_Pin|LCD_G3_Pin|LCD_G0_Pin|LCD_G2_Pin
                          |LCD_R7_Pin|LCD_R5_Pin|LCD_R6_Pin|LCD_R4_Pin
                          |LCD_R3_Pin|LCD_R1_Pin|LCD_R2_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF14_LTDC;
  HAL_GPIO_Init(GPIOJ, &GPIO_InitStruct);

  /*Configure GPIO pin : OTG_FS_VBUS_Pin */
  GPIO_InitStruct.Pin = OTG_FS_VBUS_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(OTG_FS_VBUS_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : Audio_INT_Pin */
  GPIO_InitStruct.Pin = Audio_INT_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_EVT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(Audio_INT_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : FMC_D2_Pin FMC_D3_Pin FMC_D1_Pin FMC_D15_Pin
                           FMC_D0_Pin FMC_D14_Pin FMC_D13_Pin */
  GPIO_InitStruct.Pin = FMC_D2_Pin|FMC_D3_Pin|FMC_D1_Pin|FMC_D15_Pin
                          |FMC_D0_Pin|FMC_D14_Pin|FMC_D13_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_FMC;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : OTG_FS_P_Pin OTG_FS_N_Pin OTG_FS_ID_Pin */
  GPIO_InitStruct.Pin = OTG_FS_P_Pin|OTG_FS_N_Pin|OTG_FS_ID_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_OTG_FS;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pins : SAI2_MCLKA_Pin SAI2_SCKA_Pin SAI2_FSA_Pin SAI2_SDA_Pin */
  GPIO_InitStruct.Pin = SAI2_MCLKA_Pin|SAI2_SCKA_Pin|SAI2_FSA_Pin|SAI2_SDA_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF10_SAI2;
  HAL_GPIO_Init(GPIOI, &GPIO_InitStruct);

  /*Configure GPIO pins : LCD_DE_Pin LCD_B7_Pin LCD_B6_Pin LCD_B5_Pin
                           LCD_G6_Pin LCD_G7_Pin LCD_G5_Pin */
  GPIO_InitStruct.Pin = LCD_DE_Pin|LCD_B7_Pin|LCD_B6_Pin|LCD_B5_Pin
                          |LCD_G6_Pin|LCD_G7_Pin|LCD_G5_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF14_LTDC;
  HAL_GPIO_Init(GPIOK, &GPIO_InitStruct);

  /*Configure GPIO pin : LCD_B4_Pin */
  GPIO_InitStruct.Pin = LCD_B4_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF9_LTDC;
  HAL_GPIO_Init(LCD_B4_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : SAI2_SDB_Pin */
  GPIO_InitStruct.Pin = SAI2_SDB_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF10_SAI2;
  HAL_GPIO_Init(SAI2_SDB_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : OTG_FS_PowerSwitchOn_Pin */
  GPIO_InitStruct.Pin = OTG_FS_PowerSwitchOn_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(OTG_FS_PowerSwitchOn_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : DCMI_D5_Pin */
  GPIO_InitStruct.Pin = DCMI_D5_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF13_DCMI;
  HAL_GPIO_Init(DCMI_D5_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : ARDUINO_D7_Pin ARDUINO_D8_Pin LCD_DISP_Pin */
  GPIO_InitStruct.Pin = ARDUINO_D7_Pin|ARDUINO_D8_Pin|LCD_DISP_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOI, &GPIO_InitStruct);

  /*Configure GPIO pin : uSD_Detect_Pin */
  GPIO_InitStruct.Pin = uSD_Detect_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(uSD_Detect_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : FMC_A0_Pin FMC_A1_Pin FMC_A2_Pin FMC_A3_Pin
                           FMC_A4_Pin FMC_A5_Pin FMC_A6_Pin FMC_A9_Pin
                           FMC_A7_Pin FMC_A8_Pin FMC_SDNRAS_Pin */
  GPIO_InitStruct.Pin = FMC_A0_Pin|FMC_A1_Pin|FMC_A2_Pin|FMC_A3_Pin
                          |FMC_A4_Pin|FMC_A5_Pin|FMC_A6_Pin|FMC_A9_Pin
                          |FMC_A7_Pin|FMC_A8_Pin|FMC_SDNRAS_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_FMC;
  HAL_GPIO_Init(GPIOF, &GPIO_InitStruct);

  /*Configure GPIO pins : LCD_HSYNC_Pin LCD_VSYNC_Pin LCD_R0_Pin LCD_CLK_Pin */
  GPIO_InitStruct.Pin = LCD_HSYNC_Pin|LCD_VSYNC_Pin|LCD_R0_Pin|LCD_CLK_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF14_LTDC;
  HAL_GPIO_Init(GPIOI, &GPIO_InitStruct);

  /*Configure GPIO pin : LCD_BL_CTRL_Pin */
  GPIO_InitStruct.Pin = LCD_BL_CTRL_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(LCD_BL_CTRL_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : DCMI_VSYNC_Pin */
  GPIO_InitStruct.Pin = DCMI_VSYNC_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF13_DCMI;
  HAL_GPIO_Init(DCMI_VSYNC_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : OTG_FS_OverCurrent_Pin */
  GPIO_InitStruct.Pin = OTG_FS_OverCurrent_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(OTG_FS_OverCurrent_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : SDMMC_D0_Pin */
  GPIO_InitStruct.Pin = SDMMC_D0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_SDMMC1;
  HAL_GPIO_Init(SDMMC_D0_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : TP3_Pin NC2_Pin */
  GPIO_InitStruct.Pin = TP3_Pin|NC2_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOH, &GPIO_InitStruct);

  /*Configure GPIO pin : ARDUINO_SCK_D13_Pin */
  GPIO_InitStruct.Pin = ARDUINO_SCK_D13_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF5_SPI2;
  HAL_GPIO_Init(ARDUINO_SCK_D13_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : DCMI_PWR_EN_Pin */
  GPIO_InitStruct.Pin = DCMI_PWR_EN_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(DCMI_PWR_EN_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : DCMI_D4_Pin DCMI_D3_Pin DCMI_D0_Pin DCMI_D2_Pin
                           DCMI_D1_Pin */
  GPIO_InitStruct.Pin = DCMI_D4_Pin|DCMI_D3_Pin|DCMI_D0_Pin|DCMI_D2_Pin
                          |DCMI_D1_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF13_DCMI;
  HAL_GPIO_Init(GPIOH, &GPIO_InitStruct);

  /*Configure GPIO pin : ARDUINO_PWM_CS_D5_Pin */
  GPIO_InitStruct.Pin = ARDUINO_PWM_CS_D5_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF2_TIM5;
  HAL_GPIO_Init(ARDUINO_PWM_CS_D5_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : ARDUINO_PWM_D10_Pin */
  GPIO_InitStruct.Pin = ARDUINO_PWM_D10_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF1_TIM1;
  HAL_GPIO_Init(ARDUINO_PWM_D10_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : LCD_INT_Pin */
  GPIO_InitStruct.Pin = LCD_INT_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_EVT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(LCD_INT_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : ARDUINO_RX_D0_Pin ARDUINO_TX_D1_Pin */
  GPIO_InitStruct.Pin = ARDUINO_RX_D0_Pin|ARDUINO_TX_D1_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF8_USART6;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pin : ULPI_NXT_Pin */
  GPIO_InitStruct.Pin = ULPI_NXT_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_OTG_HS;
  HAL_GPIO_Init(ULPI_NXT_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : FMC_SDNME_Pin FMC_SDNE0_Pin */
  GPIO_InitStruct.Pin = FMC_SDNME_Pin|FMC_SDNE0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_FMC;
  HAL_GPIO_Init(GPIOH, &GPIO_InitStruct);

  /*Configure GPIO pins : ARDUINO_D4_Pin ARDUINO_D2_Pin EXT_RST_Pin */
  GPIO_InitStruct.Pin = ARDUINO_D4_Pin|ARDUINO_D2_Pin|EXT_RST_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOG, &GPIO_InitStruct);

  /*Configure GPIO pins : ARDUINO_A4_Pin ARDUINO_A5_Pin ARDUINO_A1_Pin ARDUINO_A2_Pin
                           ARDUINO_A3_Pin */
  GPIO_InitStruct.Pin = ARDUINO_A4_Pin|ARDUINO_A5_Pin|ARDUINO_A1_Pin|ARDUINO_A2_Pin
                          |ARDUINO_A3_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_ANALOG;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOF, &GPIO_InitStruct);

  /*Configure GPIO pin : FMC_SDCKE0_Pin */
  GPIO_InitStruct.Pin = FMC_SDCKE0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF12_FMC;
  HAL_GPIO_Init(FMC_SDCKE0_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : ULPI_STP_Pin ULPI_DIR_Pin */
  GPIO_InitStruct.Pin = ULPI_STP_Pin|ULPI_DIR_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_OTG_HS;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pins : RMII_MDC_Pin RMII_RXD0_Pin RMII_RXD1_Pin */
  GPIO_InitStruct.Pin = RMII_MDC_Pin|RMII_RXD0_Pin|RMII_RXD1_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF11_ETH;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pin : PB2 */
  GPIO_InitStruct.Pin = GPIO_PIN_2;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF9_QUADSPI;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pins : QSPI_D1_Pin QSPI_D3_Pin QSPI_D0_Pin */
  GPIO_InitStruct.Pin = QSPI_D1_Pin|QSPI_D3_Pin|QSPI_D0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF9_QUADSPI;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pin : RMII_RXER_Pin */
  GPIO_InitStruct.Pin = RMII_RXER_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(RMII_RXER_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : RMII_REF_CLK_Pin RMII_MDIO_Pin RMII_CRS_DV_Pin */
  GPIO_InitStruct.Pin = RMII_REF_CLK_Pin|RMII_MDIO_Pin|RMII_CRS_DV_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF11_ETH;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pin : ARDUINO_A0_Pin */
  GPIO_InitStruct.Pin = ARDUINO_A0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_ANALOG;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(ARDUINO_A0_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : DCMI_HSYNC_Pin PA6 */
  GPIO_InitStruct.Pin = DCMI_HSYNC_Pin|GPIO_PIN_6;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF13_DCMI;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pins : LCD_SCL_Pin LCD_SDA_Pin */
  GPIO_InitStruct.Pin = LCD_SCL_Pin|LCD_SDA_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_OD;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF4_I2C3;
  HAL_GPIO_Init(GPIOH, &GPIO_InitStruct);

  /*Configure GPIO pins : ULPI_CLK_Pin ULPI_D0_Pin */
  GPIO_InitStruct.Pin = ULPI_CLK_Pin|ULPI_D0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_OTG_HS;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pin : ARDUINO_PWM_D6_Pin */
  GPIO_InitStruct.Pin = ARDUINO_PWM_D6_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF9_TIM12;
  HAL_GPIO_Init(ARDUINO_PWM_D6_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : ARDUINO_MISO_D12_Pin ARDUINO_MOSI_PWM_D11_Pin */
  GPIO_InitStruct.Pin = ARDUINO_MISO_D12_Pin|ARDUINO_MOSI_PWM_D11_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF5_SPI2;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

/* USER CODE BEGIN MX_GPIO_Init_2 */
/* USER CODE END MX_GPIO_Init_2 */
}

/* USER CODE BEGIN 4 */
void func(bool s,float f){

	char msg[5];//buffer de salida

	//Señal triangular
	if (s == false) {

		int sample;
		float t = 0;
		float y; // resultado

		for (sample = 0; sample < f/2; ++sample){ //f/2 muestras

			y = 255.0*t;

			sprintf(msg,"%d\n\r",(uint16_t)y);
			HAL_UART_Transmit(&huart1,(uint8_t *)msg,strlen(msg),100);
			HAL_Delay(5);

			t += 0.001;//avanzamos en el tiempo
		}

		for (sample = 0; sample < f/2; ++sample){ //f/2 muestras
			y = 255.0*t;

			sprintf(msg,"%d\n\r",(uint16_t)y);
			HAL_UART_Transmit(&huart1,(uint8_t *)msg,strlen(msg),100);
			HAL_Delay(5);

			t -= 0.001;//avanzamos en el tiempo
		}

	}

	if (s == true){
		//senoidal
		float w = 2*3.1416; //velocidad angular
		float y; // resultado
		float a = 127.5; //amplitud

		int sample;
		float t = 0;
		for (sample = 0; sample < 1000; ++sample){ //1000 muestras

			y = a*sin(w*t*f) + 127.5;

			sprintf(msg,"%d\n\r",(uint16_t)y);
			HAL_UART_Transmit(&huart1,(uint8_t *)msg,strlen(msg),100);
			HAL_Delay(5);

			t += 0.001;//avanzamos en el tiempo
		}
	}

}

/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @retval None
  */
void Error_Handler(void)
{
  /* USER CODE BEGIN Error_Handler_Debug */
  /* User can add his own implementation to report the HAL error return state */
  __disable_irq();
  while (1)
  {
  }
  /* USER CODE END Error_Handler_Debug */
}

#ifdef  USE_FULL_ASSERT
/**
  * @brief  Reports the name of the source file and the source line number
  *         where the assert_param error has occurred.
  * @param  file: pointer to the source file name
  * @param  line: assert_param error line source number
  * @retval None
  */
void assert_failed(uint8_t *file, uint32_t line)
{
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
     ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */
}
#endif /* USE_FULL_ASSERT */
